model_pattern = {
 '徕芬新一代高速家用吹风机': 'LF03',
 '铝合金电动牙刷': 'T91-铝合金',
 '不锈钢电动牙刷': 'T91-不锈钢',
 '迷你磁吸支架': '迷你磁吸支架',
 "电动牙刷充电座":'电动牙刷充电座',
 '电动牙刷数据线':'电动牙刷数据线',
 '电动牙刷适配器':'电动牙刷适配器',
 '刷头套盒3支装':'刷头套盒3支装',
 '刷头套盒6支装':'刷头套盒6支装',
 'TB31':'TB31电动牙刷',
 '钛金属版':'T91-钛金属版',
 '维修-电吹风': 'LF02',
 '独立装刷头':'独立装刷头',
 'USB-C转USB转换器':'USB-C转USB转换器',
 'Pogopin转换器':'Pogopin转换器',
 '洁丽雅毛巾': '洁丽雅毛巾w0191',
 '顺丰文件袋': '顺丰文件袋',
 '静水干发帽': '洁玉静水干发帽DST2-013',
 'ABS': 'T91-ABS',  
 '不锈钢': 'T91-不锈钢',
 '铝合金': 'T91-铝合金',
 '塑胶版': 'T91-ABS',
 '塑胶': 'T91-ABS',
 '电动牙刷': 'T91-ABS',
 'HD30MINIlite': 'HD30 MINIlite',
 'LFHDMINIlite': 'LFHD MINIlite',
 'LFHDSE-Lite': 'LFHD SE-Lite',
 'LF03&LF03SE': 'LF03&LF03SE',
 'HD31MINI': 'HD31-MINI',
 'LFHDMINI': 'LFHD-MINI',
 'MINIlite': 'MINI-Lite',
 'MiniLite': 'MINI-Lite',
 'LF04MINI': 'LF04MINI',
 'MINILITE': 'MINILITE',
 'LFHDSE2': 'LFHD-SE 2',
 'LF03SE': 'LF03-SE',
 'LF03-SE':'LF03-SE',
 'LF03-S':'LF03-S',
 'LF03': 'LF03',
 'LF02': 'LF02',
 'SE': 'LF03-SE',
 'se': 'LF03-SE',
 'LF01':'LF01',
 'LFHDMini':'LFHDMini',
 }


model_pattern2 = {
 'TB31':'TB31电动牙刷',
 '钛金属版':'T91-钛金属版',
 '维修-电吹风': 'LF02',
 '洁丽雅毛巾': '洁丽雅毛巾w0191',
 '顺丰文件袋': '顺丰文件袋',
 '静水干发帽': '洁玉静水干发帽DST2-013',
 'ABS': 'T91-ABS',  
 '不锈钢': 'T91-不锈钢',
 '铝合金': 'T91-铝合金',
 '塑胶版': 'T91-ABS',
 '塑胶': 'T91-ABS',
 '电动牙刷': 'T91-ABS',
 'HD30MINIlite': 'HD30 MINIlite',
 'LFHDMINIlite': 'LFHD MINIlite',
 'LFHDSE-Lite': 'LFHD SE-Lite',
 'LF03&LF03SE': 'LF03&LF03SE',
 'HD31MINI': 'HD31-MINI',
 'LFHDMINI': 'LFHD-MINI',
 'MINIlite': 'MINI-Lite',
 'MiniLite': 'MINI-Lite',
 'LF04MINI': 'LF04MINI',
 'MINILITE': 'MINILITE',
 'LFHDSE2': 'LFHD-SE 2',
 'LF03SE': 'LF03-SE',
 'LF03-SE':'LF03-SE',
 'LF03-S':'LF03-S',
 'LF03': 'LF03',
 'LF02': 'LF02',
 'SE': 'LF03-SE',
 'se': 'LF03-SE',
 'LF01':'LF01',
 'LFHDMini':'LFHDMini',
 }

color_pattern = {
    '白色': '白色',
    '透明':'透明',
    '不锈钢': '不锈钢',
    '淡雅灰':'淡雅灰',
    '中国红': '中国红',
    '亮白': '亮白',
    '亮白色': '亮白色',
    '光感白': '光感白',
    '冰川蓝': '冰川蓝',
    '冰川银': '冰川银',
    '圣诞蓝金': '圣诞蓝金',
    '奶茶': '奶茶',
    '奶茶色': '奶茶色',
    '幻夜黑': '幻夜黑',
    '抹茶绿': '抹茶绿',
    '星空紫': '星空紫',
    '星空银': '星空银',
    '极光蓝': '极光蓝',
    '梦幻紫': '梦幻紫',
    '极光粉':'极光粉',
    '原色':'原色',
    '素雅白':'素雅白',
    '深枪色':'深枪色',
    '粉':'粉',
    '蓝':'蓝',
    '白':'白',
    '绿':'绿',
    '海盐青':'海盐青',
    '奶油黄':'奶油黄',
    '敦煌红':'敦煌红',
    '浅黄':'浅黄',
    '沙金色':'沙金色',
    '樱粉': '樱粉',
    '浅岛绿': '浅岛绿',
    '浅灰': '浅灰',
    '浅粉': '浅粉',
    '浅紫': '浅紫',
    '浅绿': '浅绿',
    '浅蓝': '浅蓝',
    '深灰': '深灰',
    '深空灰': '深空灰',
    '深紫': '深紫',
    '深蓝': '深蓝',
    '冰川蓝':'冰川蓝',
    '灰色': '灰色',
    '熔岩红': '熔岩红',
    '牛奶粉': '牛奶粉',
    '白+奶茶': '白+奶茶',
    '白+灰': '白+灰',
    '白+粉': '白+粉',
    '白+蓝': '白+蓝',
    '白+黄': '白+黄',
    '白金': '白金',
    '皓月白': '皓月白',
    '简白': '简白',
    '粉+蓝': '粉+蓝',
    '粉色': '粉色',
    '粉金': '粉金',
    '紫色': '紫色',
    '红色': '红色',
    '绿色': '绿色',
    '绿野': '绿野',
    '蓝+奶茶': '蓝+奶茶',
    '蓝+紫': '蓝+紫',
    '蓝灰': '蓝灰',
    '蓝灰色': '蓝灰色',
    '蓝色': '蓝色',
    '蓝金': '蓝金',
    '透明': '透明',
    '金粉': '金粉',
    '铝合金': '铝合金',
    '铝合金粉色': '铝合金粉色',
    '铝合金紫色': '铝合金紫色',
    '铝合金蓝色': '铝合金蓝色',
    '银色': '银色',
    '镜黑': '镜黑',
    '闪银': '闪银',
    '青山绿': '青山绿',
    '青柚': '青柚',
    '黄+灰': '黄+灰',
    '黄+白': '黄+白',
    '黄色': '黄色',
    '黑色': '黑色'}


part_pattern = {
    '羊毛毡支架 PC 注塑 灰色PT427U':'羊毛毡支架 PC 注塑 灰色PT427U',
    '护龈刷头缓震款透明3支装/新包胶刷头':'护龈刷头缓震款透明3支装/新包胶刷头',
    '护龈刷头缓震款透明6支装/新包胶刷头':'护龈刷头缓震款透明6支装/新包胶刷头',
    '标准热缩膜（装带滤波器）LF02共用':'标准热缩膜（装带滤波器）LF02共用',
    '护龈刷头缓震款透明3支装/包胶刷头':'护龈刷头缓震款透明3支装/包胶刷头',
    '护龈刷头缓震款透明单支装/包胶刷头':'护龈刷头缓震款透明单支装/包胶刷头',
    '旅行盒奶茶色刷头通配适配ABS版':'旅行盒奶茶色刷头通配适配ABS版',
    '旅行盒绿色色刷头通配适配ABS版':'旅行盒绿色色刷头通配适配ABS版',
    '电动牙刷堆头':'电动牙刷堆头',
    '电动牙刷PDQ':'电动牙刷PDQ',
    '旅行盒刷头':'旅行盒刷头',
    '电动牙刷展架':'电动牙刷展架',
    '按摩梳':'按摩梳',
    '挂壁支架胶水':'挂壁支架胶水',
    '挂壁支架':'挂壁支架',
    '亚克力简易支架':'亚克力简易支架',
    "电动牙刷充电座":'电动牙刷充电座',
    '官配刷头':'官配刷头',
    '卷发梳':'卷发梳',
    '展示架':'展示架',
    'L形金属展示架':'L形金属展示架',
    'L形展示架':'L形展示架',
    '通用展架':'通用展架',
    '收纳皮盒':'收纳皮盒',
    '旅行盒白色刷头通配适配ABS版':'旅行盒白色刷头通配适配ABS版',
    '旅行盒粉色刷头通配适配ABS版':'旅行盒粉色刷头通配适配ABS版',
    '旅行盒紫色刷头通配适配ABS版':'旅行盒紫色刷头通配适配ABS版',
    '旅行盒蓝色刷头通配适配ABS版':'旅行盒蓝色刷头通配适配ABS版',
    '旅行盒黄色刷头通配适配ABS版':'旅行盒黄色刷头通配适配ABS版',
    '旅行盒黑色刷头通配适配ABS版':'旅行盒黑色刷头通配适配ABS版',
    '电机套 （铝合金、不锈钢共用）':'电机套 （铝合金、不锈钢共用）',
    '情人节礼盒-奶茶色-底盒标签':'情人节礼盒-奶茶色-底盒标签',
    '情人节礼盒-白色-底盒标签':'情人节礼盒-白色-底盒标签',
    '情人节礼盒-粉色-底盒标签':'情人节礼盒-粉色-底盒标签',
    '情人节礼盒-紫色-底盒标签':'情人节礼盒-紫色-底盒标签',
    '情人节礼盒-绿色-底盒标签':'情人节礼盒-绿色-底盒标签',
    '情人节礼盒-蓝色-底盒标签':'情人节礼盒-蓝色-底盒标签',
    '情人节礼盒-黄色-底盒标签':'情人节礼盒-黄色-底盒标签',
    'USB-C转USB转换器':'USB-C转USB转换器',
    '旅行盒奶茶色适配ABS版':'旅行盒奶茶色适配ABS版',
    '发热丝组件（220V':'发热丝组件（220V',
    '情人节礼盒国内底盒标签':'情人节礼盒国内底盒标签',
    '旅行盒白色适配ABS版':'旅行盒白色适配ABS版',
    '旅行盒粉色适配ABS版':'旅行盒粉色适配ABS版',
    '旅行盒紫色适配ABS版':'旅行盒紫色适配ABS版',
    '旅行盒绿色适配ABS版':'旅行盒绿色适配ABS版',
    '旅行盒蓝色适配ABS版':'旅行盒蓝色适配ABS版',
    '旅行盒黄色适配ABS版':'旅行盒黄色适配ABS版',
    '旅行盒黑色适配ABS版':'旅行盒黑色适配ABS版',
    'Pogopin转换器':'Pogopin转换器',
    '壁挂支架ABS款':'壁挂支架ABS款',
    '电动牙刷透明护龈刷头':'电动牙刷透明护龈刷头',
    '壁挂支架金属款':'壁挂支架金属款',
    '电动牙刷旅行盒白色':'电动牙刷旅行盒白色',
    '电动牙刷适配器套装':'电动牙刷适配器套装',
    '电源线标准1.5M':'电源线标准1.5M',
    '电源线标准1.7M':'电源线标准1.7M',
    '白盒封盒贴纸（上）':'白盒封盒贴纸（上）',
    '白盒封盒贴纸（下）':'白盒封盒贴纸（下）',
    '拨动温控开关组件':'拨动温控开关组件',
    '新包胶刷头单支装':'新包胶刷头单支装',
    '铝合金 主体外壳':'铝合金 主体外壳',
    'USB-C电源':'USB-C电源',
    '刷头套盒3支装':'刷头套盒3支装',
    '刷头套盒6支装':'刷头套盒6支装',
    '刷头套盒6支混合装':'刷头套盒6支混合装',
    '刷头缓震款3支装':'刷头缓震款3支装',
    '包胶刷头单支装':'包胶刷头单支装',
    '双色把手内壳上':'双色把手内壳上',
    '导风嘴220V':'导风嘴220V',
    '导风嘴带螺丝孔':'导风嘴带螺丝孔',
    '档位开关座压板':'档位开关座压板',
    '电机轴防水软胶':'电机轴防水软胶',
    '开关风速按钮':'开关风速按钮',
    '温度调节按钮':'温度调节按钮',
    '温控开关按钮':'温控开关按钮',
    '电源线连插头':'电源线连插头',
    '吹风机支架（带防盗扣，酒店专用款）':'吹风机支架(酒店专用款)',
    '聚风风嘴':'聚风风嘴',
    '磁吸壁挂支架':'磁吸壁挂支架',
    '迷你创意支架':'迷你创意支架',
    '挂壁架':'挂壁架',
    '顺滑风嘴':'顺滑风嘴',
    '礼盒版手提袋':'礼盒版手提袋',
    '返工底盒标签':'返工底盒标签',
    '迷你磁吸支架':'迷你磁吸支架',
    '风机挂壁架':'风机挂壁架',
    '吹风机展架':'吹风机展架',
    '标准展示架':'标准展示架',
    'Retro三合一配件盒':'Retro三合一配件盒',
    '磁吸支架':'磁吸支架',
    '风速开关按钮':'风速开关按钮',
    '红包套装':'红包套装',
    'USB-A转TYPE-C转换器':'USB-A转TYPE-C转换器',
    '仿绒收纳袋':'仿绒收纳袋',
    '双色内壳上':'双色内壳上',
    '双色导风嘴':'双色导风嘴',
    '导风嘴组件':'导风嘴组件',
    '开关保护盖':'开关保护盖',
    '把手内壳下':'把手内壳下',
    '收纳包外盒':'收纳包外盒',
    '数据线套装':'电动牙刷数据线套装',
    '旅行收纳包':'旅行收纳包',
    '标准热缩膜':'标准热缩膜',
    '温控开关板':'温控开关板',
    '独立装刷头':'独立装刷头',
    '电源线压块':'电源线压块',
    '电源线尾座':'电源线尾座',
    '羊毛毡支架':'羊毛毡支架',
    '铁片固定座':'铁片固定座',
    '后盖组件':'后盖组件',
    '壁挂支架':'壁挂支架',
    '开关滑片':'开关滑片',
    '扩散风嘴':'扩散风嘴',
    '把手外壳':'把手外壳',
    '电线尾座':'电线尾座',
    '迷你支架':'迷你支架',
    '顺滑风嘴':'顺滑风嘴',
    '风嘴铁环':'风嘴铁环',
    '风筒外壳':'风筒外壳',
    '梳子套盒':'梳子套盒',
    '梳子':'梳子',
    '69码':'69码',
    '内滤网':'内滤网',
    '后盖上':'后盖上',
    '外壳带':'外壳带',
    '外滤网':'外滤网',
    '收纳包':'收纳包',
    '收纳袋':'收纳袋',
    '束线带':'束线带',
    '气垫梳':'气垫梳',
    '聚风嘴':'聚风嘴',
    '后盖':'后盖',
    '外壳':'外壳',
    '底盖':'底盖',
    '铁环':'铁环',
}  
import pandas as pd
from tqdm import tqdm
import re

tqdm.pandas(desc="Fucking Processing.......")

def match_label(row):
    for key, value in tqdm(model_pattern2.items(),desc="WUHU------------"):
        # if pd.isnull(row['型号']) or pd.isna(row['型号']):
            if re.search(re.escape(key), row['名称']):
                return value
    return ''
       

def match_color(row):
    for key,value in tqdm(color_pattern.items(), desc='WDDDD-------'):
        if re.search(re.escape(key), row['名称']):
            return value
    return ''           

def match_part(row):
     for key, value in tqdm(part_pattern.items(), desc='WDWDDD--------!'):
           if re.search(re.escape(key), row['名称']):
                return value
     return ''

def match():
    df = pd.read_excel('我的映射表.xlsx',sheet_name='吹风机配件')
    df['名称'] = df['名称'].astype("str")
    df['型号'] = df['型号'].astype("str")
    df['颜色'] = df['颜色'].astype("str")
    df['名称'] = df['名称'].str.replace(" ",'')
   

    df['型号'] = df.progress_apply(match_label, axis=1)
    df['颜色'] = df.progress_apply(match_color, axis=1)
    df['副件'] = df.progress_apply(match_part, axis=1)

    df['型号'] = df['型号'].str.replace(" ",'')
    df['颜色'] = df['颜色'].str.replace(" ",'')

    with pd.ExcelWriter('output\输出.xlsx') as writer:
        df.to_excel(writer,index=False)
    print('Doneee!---')

match()
    